<!doctype html><html lang=zh-cn itemscope itemtype=http://schema.org/WebPage><head><meta name=generator content="Hugo 0.119.0"><meta charset=utf-8><title>JVM 中你不得不知的一些参数 · 古时的风筝</title><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=description content="有的同学虽然写了一段时间 Java 了，但是对于 JVM 却不太关注。有的同学说，参数都是团队规定好的，部署的时候也不用我动手，关注它有什么用，而且，JVM 这"><meta name=360-site-verification content="e75339f1cfcde17f66f71aaf8b6983e9"><meta name=keywords content="Hugo,theme,编程,java,ChatGPT,程序员,开发"><meta name=google-site-verification content="google57680cd58c46e2f3.html"><link rel=canonical href=https://www.moonkite.cn/category/java/JVM-%E4%B8%AD%E4%BD%A0%E4%B8%8D%E5%BE%97%E4%B8%8D%E7%9F%A5%E7%9A%84%E4%B8%80%E4%BA%9B%E5%8F%82%E6%95%B0/><link rel=icon href=https://www.moonkite.cn/images/photo.png><link rel=stylesheet href=https://cdn.staticfile.org/twitter-bootstrap/4.1.3/js/bootstrap.min.js><link rel=stylesheet href=https://www.moonkite.cn/css/den.css><link href=https://cdn.bootcdn.net/ajax/libs/lxgw-wenkai-screen-webfont/1.6.0/style.min.css rel=stylesheet><script async src=//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js></script><meta name=referrer content="no-referrer-when-downgrade"><meta property="og:title" content="JVM 中你不得不知的一些参数"><meta property="og:description" content="有的同学虽然写了一段时间 Java 了，但是对于 JVM 却不太关注。有的同学说，参数都是团队规定好的，部署的时候也不用我动手，关注它有什么用，而且，JVM 这"><meta property="og:type" content="article"><meta property="og:url" content="https://www.moonkite.cn/category/java/JVM-%E4%B8%AD%E4%BD%A0%E4%B8%8D%E5%BE%97%E4%B8%8D%E7%9F%A5%E7%9A%84%E4%B8%80%E4%BA%9B%E5%8F%82%E6%95%B0/"><meta property="article:section" content="category"><meta property="article:published_time" content="2019-11-15T08:56:23+08:00"><meta property="article:modified_time" content="2019-11-15T08:56:23+08:00"><meta itemprop=name content="JVM 中你不得不知的一些参数"><meta itemprop=description content="有的同学虽然写了一段时间 Java 了，但是对于 JVM 却不太关注。有的同学说，参数都是团队规定好的，部署的时候也不用我动手，关注它有什么用，而且，JVM 这"><meta itemprop=datePublished content="2019-11-15T08:56:23+08:00"><meta itemprop=dateModified content="2019-11-15T08:56:23+08:00"><meta itemprop=wordCount content="2431"><meta itemprop=keywords content="Java,JDK,JVM,jvm参数,"><meta name=twitter:card content="summary"><meta name=twitter:title content="JVM 中你不得不知的一些参数"><meta name=twitter:description content="有的同学虽然写了一段时间 Java 了，但是对于 JVM 却不太关注。有的同学说，参数都是团队规定好的，部署的时候也不用我动手，关注它有什么用，而且，JVM 这"></head><body><div class=header-container style=background:linear-gradient(rgba(0,0,0,.2),rgba(0,0,0,.2)),url(https://hexo.moonkite.cn/blog/background.png);background-position:top;background-size:cover><div class=container><nav class="header-nav navbar navbar-expand-md navbar-dark light-dark"><div class="header-logo navbar-brand"><a class=float-left href=https://www.moonkite.cn/></a></div><button class=navbar-toggler type=button data-toggle=collapse data-target=#navbarNav aria-controls=navbarNav aria-expanded=false aria-label="Toggle navigation">
<span class=navbar-toggler-icon></span></button><div class="nav-menu collapse navbar-collapse" id=navbarNav><ul class=navbar-nav><li class=nav-item><a href=https://www.moonkite.cn/ class=nav-link><i class="fas fad fa-h-square"></i>主页</a></li><li class=nav-item><a href=https://www.moonkite.cn/category/notes class=nav-link><i class='fas fa-yin-yang'></i>生活随笔</a></li><li class=nav-item><a href=javascript:void(0) class=nav-link><i class='fas fa-laptop-code'></i>技术文章</a><div class=sub-dropdown-menu><a class=sub-nav-link href=https://www.moonkite.cn/category/java><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 48 48"><path fill="#f44336" d="M23.65 24.898c-.998-1.609-1.722-2.943-2.725-5.455C19.229 15.2 31.24 11.366 26.37 3.999c2.111 5.089-7.577 8.235-8.477 12.473-.823 3.898 5.752 8.426 5.757 8.426z"/><path fill="#f44336" d="M23.878 17.27c-.192 2.516 2.229 3.857 2.299 5.695.056 1.496-1.447 2.743-1.447 2.743s2.728-.536 3.579-2.818c.945-2.534-1.834-4.269-1.548-6.298.267-1.938 6.031-5.543 6.031-5.543S24.311 11.611 23.878 17.27z"/><g><path fill="#1565c0" d="M32.084 25.055c1.754-.394 3.233.723 3.233 2.01.0 2.901-4.021 5.643-4.021 5.643s6.225-.742 6.225-5.505c0-3.15-3.057-3.937-5.437-2.148zm-2.955 2.34s1.941-1.383 2.458-1.902c-4.763 1.011-15.638 1.147-15.638.269.0-.809 3.507-1.638 3.507-1.638s-7.773-.112-7.773 2.181C11.683 28.695 21.858 28.866 29.129 27.395z"/><path fill="#1565c0" d="M27.935 29.571c-4.509 1.499-12.814 1.02-10.354-.993-1.198.0-2.974.963-2.974 1.889.0 1.857 8.982 3.291 15.63.572l-2.302-1.468z"/><path fill="#1565c0" d="M18.686 32.739c-1.636.0-2.695 1.054-2.695 1.822.0 2.391 9.76 2.632 13.627.205l-2.458-1.632C24.271 34.404 17.014 34.579 18.686 32.739z"/><path fill="#1565c0" d="M36.281 36.632c0-.936-1.055-1.377-1.433-1.588 2.228 5.373-22.317 4.956-22.317 1.784.0-.721 1.807-1.427 3.477-1.093l-1.42-.839C11.26 34.374 9 35.837 9 37.017 9 42.52 36.281 42.255 36.281 36.632z"/><path fill="#1565c0" d="M39 38.604c-4.146 4.095-14.659 5.587-25.231 3.057C24.341 46.164 38.95 43.628 39 38.604z"/></g></svg>&nbsp;可爱的 Java</a>
<a class=sub-nav-link href=https://www.moonkite.cn/category/SpringCloud><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 48 48"><path fill="#8bc34a" d="M43.982 23.635c.069-4.261-.891-9.328-2.891-15.273L39.523 3.7l-2.13 4.433c-.114.237-.244.469-.38.698C33.514 5.827 28.974 4 24 4 12.954 4 4 12.954 4 24s8.954 20 20 20 20-8.954 20-20C44 23.877 43.984 23.758 43.982 23.635z"/><path fill="#fff" d="M39.385 32.558C36.262 36.86 30.734 37.091 25.531 37H18.75h-1.938c4.428-1.593 7.063-1.972 9.754-3.4 5.068-2.665 10.078-8.496 11.121-14.562-1.93 5.836-7.779 10.85-13.109 12.889-3.652 1.393-10.248 2.745-10.248 2.745l-.267-.145C9.573 32.268 9.437 22.214 17.6 18.968c3.574-1.423 6.993-.641 10.854-1.593 4.122-1.012 8.89-4.208 10.83-8.375C41.456 15.667 44.07 26.106 39.385 32.558zM15.668 38.445C15.386 38.795 14.955 39 14.505 39c-.823.0-1.495-.677-1.495-1.5s.677-1.5 1.495-1.5c.341.0.677.118.941.336C16.086 36.855 16.186 37.805 15.668 38.445z"/></svg>&nbsp; Spring Cloud 系列</a>
<a class=sub-nav-link href=https://www.moonkite.cn/category/other><img width=20 height=20 src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADIAAAAyCAYAAAAeP4ixAAAACXBIWXMAAAsTAAALEwEAmpwYAAADWElEQVR4nO2X30tTYRjH9xd4X2Dsol1EEtJdEFiSF10pldlVaVHEjiFFkKQVQeV0kfSTHdfW1pzKlpZtzXJuzp2pmzPFTdmUTdLJlEAvNKyB8MYzPG/visHZ2jxrnQc+8PCc85zz/e592XkfkUgIIYT4v2OoTVrtVFDTjILaYmgK8YqC2oproalzKZlwKqga3sXTSeFuZts9ykWcNOXnbITcTj67IRQcG1rlE5/dECK3GXcjxC8ADwqMuxGfBMeGVklNaRmZ83z0L3+ZR3ywMBfInJHQqGl07esKAmYjK6hnJoph64Ar/KsOOXmNK6HOTszKtD9uJitGQGSRcQFDiqh1RHAd8nSMWMQSDJgRjLAhrIgxta3lDvaiRlMpxvKvbi3BCNfI+xVRehdRIT2DIUWdejeH65BzMWKd1KO6jqOYLrEE46fp7Bm5bgki0Q0bhhS1t3UM1yHnYuS1XY5Oy0swD8USjPNmQ2aNfO6WO0KjphHgbrc9XNjsirGwdeAY7Vpl65CT15LRYb4VltLHYyzKAwcxgw3Xwr5BQ9D9ll53dz9d+msjfNLfWoO6GstR7/0zCXXBCJMPKxLMl3kkmC9GQsTf706znK3vyKLdhtznL2ISPm5TaqQdro8DeTJxm4EHKDZRGQfy308HtdvAcJY1I3BsII8RpAgwwB41IE9mBAwgR0EcyMlrRcTxB45DgpFUV+RbSIMxuq4kXRFyFl+3VuTeiqBtQYCDqUxqhOyJPCsTjDDCitB5urW8zS2oTSzBxNS7MB3tpeiC4kicO8azCQLJnkB9Me750Xs44b4CmQcjc4SzZwSGHXL42Xy0B6NTHMIDUp36RIJAsmeS2od7vuuKE+4TEUMbDHGZMLLBNrlUV/3u9sYRwH7vkq/nZFmUJaotwfRoK5bk6qoooNRUh9kegOyZkpUtsT3zuvKE+6qev4myKF899nkNTeMTJuWsu6spTBjZ4GzESUv7+R6qmCQ4aeoTZyPDLy4XMTS1xrdo5k/WmDbpflEq4XpJ7XbS1O0+bYvnve7JLNCnkXkZWmrYCfo0Mi9+r7bFA1pAkyjd0Ov1EZVKhQDI034Q3++1mM39H8xmBECeEZV8vNdmtRptAwMojtVqzIjKHH6vEEIIIcrt+AnU4LBcH67z1wAAAABJRU5ErkJggg=="> &nbsp; 杂七杂八</a></div></li><li class=nav-item><a href=https://www.moonkite.cn/category/network class=nav-link><i class="fas fa-network-wired"></i>轻解计算机网络</a></li><li class=nav-item><a href=https://www.moonkite.cn/category/product class=nav-link><i class="fas fab fa-medapps"></i>我的产品</a></li></ul></div></nav></div><div class="container header-wrapper"><div class=row><div class=col-lg-12><div class=header-content><h1 class=header-title>JVM 中你不得不知的一些参数</h1><p class=header-date>作者：
风筝 /
2019-11-15<div class=header-underline></div><div class=header-date>&nbsp·&nbsp
  <span id=busuanzi_container_page_pv>本文被阅读<span id=busuanzi_value_page_pv></span>次</span></div><div class=clearfix></div><p class="float-right header-tags"><i class="fas fa-tags" aria-hidden=true></i>
<a href=https://www.moonkite.cn/tag/Java/>Java</a>,
<a href=https://www.moonkite.cn/tag/JDK/>JDK</a>,
<a href=https://www.moonkite.cn/tag/JVM/>JVM</a>,
<a href=https://www.moonkite.cn/tag/jvm%E5%8F%82%E6%95%B0/>jvm参数</a></p></div></div></div></div></div><main><div class="container content"><article><p>有的同学虽然写了一段时间 Java 了，但是对于 JVM 却不太关注。有的同学说，参数都是团队规定好的，部署的时候也不用我动手，关注它有什么用，而且，JVM 这东西，听上去就感觉很神秘很高深的样子，还是算了吧。</p><p>没错，部署的时候可能用不到你亲自动手，但是出现问题了怎么办，难道不用你解决问题吗，如果对 JVM 了解不够的话，有些问题可能排查起来就很费力，或者根本无法解决。</p><p>本篇以 JDK Hotspot 8 为背景，介绍一下 JVM 的常用参数。建议你在做一些小项目、小 demo 的时候，也把这些参数加上，加深印象。以我的经验来看，有些知识你刚开始接触的时候会感觉很难理解，但是没关系，万事开头难嘛，知识点都是需要消化时间的。第一天不理解，甚至过了一个月也不理解，但是总有那么一刻，你会突然有种茅塞顿开的感觉，感觉一下子通了。最后心里面感谢自己在多少多少天以前能够开始学习并坚持学习这些知识点。</p><p>只介绍一些常用参数，除了这些常用参数外，Hotspot 还提供了很多其他的参数，每一个都值得考究。</p><p>在使用这些参数之前，你需要对 Java 内存模型有一定的了解，可以读一下 <a href=https://mp.weixin.qq.com/s/Liy8XYbJn9qfOAdVA4xx5w>这篇文章</a> 了解一下内存模型。</p><p>还是要把内存模型图放在这里，方便理解。</p><p><img src=https://hexo.moonkite.cn/blog/273364-20191115085215712-164982994.png alt></p><h4 id=堆参数>堆参数：</h4><p><strong>-Xms</strong>: 堆的初始值，例如 -Xmx2048，初始堆大小为 2G</p><p><strong>-Xmx</strong>: 堆的最大值，例如 -Xmx2048M，允许最大堆内存 2G</p><p><strong>-Xmn</strong>: 新生代大小</p><p><strong>-XX:SurvivorRatio</strong>：Eden 区所占比例，默认是 8，也就是 80%，例如 -XX:SurvivorRatio=8
<img src=https://hexo.moonkite.cn/blog/273364-20191115085258014-1578600626.png alt></p><blockquote><p>最好将 -Xms 和 -Xmx 的值设置成一样的值，这样做是为了防止随着堆空间使用量增加，会动态的调整堆空间大小，有一定的性能损耗，不如开始就设置成相同的值，来规避性能损失。</p></blockquote><h4 id=栈参数>栈参数</h4><p><strong>-Xss</strong>：栈空间大小，栈是线程独占的，所以是一个线程使用栈空间的大小，例如 -Xss256K，如果不设置此参数，默认值是 1M，一般来讲设置成 256K 就足够了。</p><h4 id=metaspace-参数>Metaspace 参数</h4><p><strong>-XX:MetaspaceSize</strong>：Metaspace 空间初始大小，如果不设置的话，默认是20.79M，这个初始大小是触发首次 Metaspace Full GC 的阈值，例如 -XX:MetaspaceSize=256M</p><p><strong>-XX:MaxMetaspaceSize</strong>：Metaspace 最大值，默认不限制大小，但是线上环境建议设置，例如</p><p>-XX:MaxMetaspaceSize=256M</p><p><strong>-XX:MinMetaspaceFreeRatio</strong>：最小空闲比，当 Metaspace 发生 GC 后，会计算 Metaspace 的空闲比，如果空闲比(空闲空间/当前 Metaspace 大小)小于此值，就会触发 Metaspace 扩容。默认值是 40 ，也就是 40%，例如 -XX:MinMetaspaceFreeRatio=40</p><p><strong>-XX:MaxMetaspaceFreeRatio</strong>:最大空闲比，当 Metaspace 发生 GC 后，会计算 Metaspace 的空闲比，如果空闲比(空闲空间/当前 Metaspace 大小)大于此值，就会触发 Metaspace 释放空间。默认值是 70 ，也就是 70%，例如 -XX:MaxMetaspaceFreeRatio=70</p><blockquote><p>建议将 MetaspaceSize 和 MaxMetaspaceSize 设置为同样大小，避免频繁扩容。</p></blockquote><h4 id=gc-日志>GC 日志</h4><p><strong>简单日志</strong></p><p><code>-verbose:gc 或者 -XX:+PrintGC</code></p><p>日志格式：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=o>[</span>GC <span class=o>(</span>Allocation Failure<span class=o>)</span>  7892K-&gt;5646K<span class=o>(</span>19456K<span class=o>)</span>, 0.0060442 secs<span class=o>]</span>
</span></span><span class=line><span class=cl><span class=o>[</span>GC <span class=o>(</span>Allocation Failure<span class=o>)</span> , 0.0066315 secs<span class=o>]</span>
</span></span><span class=line><span class=cl><span class=o>[</span>Full GC <span class=o>(</span>Allocation Failure<span class=o>)</span>  19302K-&gt;13646K<span class=o>(</span>19456K<span class=o>)</span>, 0.0032698 secs<span class=o>]</span>
</span></span></code></pre></div><p><strong>详细日志</strong></p><div class=highlight><pre tabindex=0 class=chroma><code class=language-properties data-lang=properties><span class=line><span class=cl><span class=c1>#打印详细日志</span>
</span></span><span class=line><span class=cl><span class=na>-XX</span><span class=o>:</span><span class=s>+PrintGCDetails</span>
</span></span><span class=line><span class=cl><span class=c1>#打印 GC 的时间点</span>
</span></span><span class=line><span class=cl><span class=na>-XX</span><span class=o>:</span><span class=s>+PrintGCDateStamps</span>
</span></span></code></pre></div><p>日志格式：</p><pre tabindex=0><code>2019-11-13T14:06:46.099-0800: [GC (Allocation Failure) 2019-11-13T14:06:46.099-0800: [DefNew (promotion failed) : 9180K-&gt;9157K(9216K), 0.0084297 secs]2019-11-13T14:06:46.107-0800: [Tenured: 10145K-&gt;10145K(10240K), 0.0035768 secs] 13802K-&gt;13646K(19456K), [Metaspace: 3895K-&gt;3895K(1056768K)], 0.0120887 secs] [Times: user=0.00 sys=0.00, real=0.02 secs] 
2019-11-13T14:06:47.243-0800: [Full GC (Allocation Failure) 2019-11-13T14:06:47.244-0800: [Tenured: 10145K-&gt;10145K(10240K), 0.0042686 secs] 19304K-&gt;19146K(19456K), [Metaspace: 3895K-&gt;3895K(1056768K)], 0.0043232 secs] [Times: user=0.00 sys=0.00, real=0.00 secs] 
</code></pre><p>以下几个 GC 日志相关的参数打印的内容比较多，生产环境可选择性开启，大多数时候不需要开启。</p><p><strong>GC 前后的堆信息</strong></p><p><code>-XX:+PrintHeapAtGC</code></p><pre tabindex=0><code>{Heap before GC invocations=0 (full 0):
 def new generation   total 9216K, used 7892K [0x00000007bec00000, 0x00000007bf600000, 0x00000007bf600000)
  eden space 8192K,  96% used [0x00000007bec00000, 0x00000007bf3b5200, 
  xxx....
  class space    used 445K, capacity 462K, committed 512K, reserved 1048576K
Heap after GC invocations=1 (full 0):
 def new generation   total 9216K, used 1023K [0x00000007bec00000,
 xxx...
 Metaspace       used 3892K, capacity 4646K, committed 4864K, reserved 1056768K
  class space    used 445K, capacity 462K, committed 512K, reserved 1048576K
}
</code></pre><p><strong>GC 导致的 Stop the world 时间</strong></p><p><code>-XX:+PrintGCApplicationStoppedTime</code></p><pre tabindex=0><code>Total time for which application threads were stopped: 0.0070384 seconds, Stopping threads took: 0.0000200 seconds
</code></pre><p><strong>加载类信息</strong></p><p><code>-verbose:class</code></p><pre tabindex=0><code>[Loaded java.net.URLClassLoader$3$1 from /Library/Java/JavaVirtualMachines/jdk1.8.0_111.jdk/Contents/Home/jre/lib/rt.jar]
</code></pre><p><strong>GC 前后的类加载情况</strong></p><div class=highlight><pre tabindex=0 class=chroma><code class=language-properties data-lang=properties><span class=line><span class=cl><span class=na>-XX</span><span class=o>:</span><span class=s>+PrintClassHistogramBeforeFullGC</span>
</span></span><span class=line><span class=cl><span class=na>-XX</span><span class=o>:</span><span class=s>+PrintClassHistogramAfterFullGC</span>
</span></span></code></pre></div><pre tabindex=0><code> num     #instances         #bytes  class name
----------------------------------------------
   1:           140       19016264  [B
   2:          2853         226256  [C
   3:           138         169072  [I
   4:           761          86240  java.lang.Class
   5:          2850          68400  java.lang.String
   6:           660          41024  [Ljava.lang.Object;
</code></pre><p><strong>日志输出到文件</strong></p><p>以上参数配置好之后，默认会输出到控制台或者服务指定的统一日志的位置。但是这里还会有服务的一般性信息日志、错误日志等，都混在一起的话会比较乱，所以，一般都会把 jvm 日志单独存放。</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-properties data-lang=properties><span class=line><span class=cl><span class=c1>#GC 活动日志，根据配置的参数输出内容</span>
</span></span><span class=line><span class=cl><span class=na>-Xloggc</span><span class=o>:</span><span class=s>/Users/fengzheng/jvmlog/gc.log</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>#致命错误日志，只有在 jvm 发生崩溃的时候会输出</span>
</span></span><span class=line><span class=cl><span class=na>-XX</span><span class=o>:</span><span class=s>ErrorFile=/Users/fengzheng/jvmlog/hs_err_pid%p.log</span>
</span></span></code></pre></div><p><strong>堆溢出现场保留</strong></p><p>有些错误虽然不会导致 jvm 崩溃，但是对于服务而言也是非常严重的，比如stackOverflow、OutOfMemoryError，发生错误后，留存现场信息对分析错误原因是至关重要的。jvm 提供了保留堆溢出现场的方法，对于 JDK 8 而言，可能是 heap 溢出，也可能是 Metasapce 溢出。</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-properties data-lang=properties><span class=line><span class=cl><span class=na>-XX</span><span class=o>:</span><span class=s>HeapDumpPath=/Users/fengzheng/jvmlog</span>
</span></span><span class=line><span class=cl><span class=na>-XX</span><span class=o>:</span><span class=s>+HeapDumpOnOutOfMemoryError</span>
</span></span></code></pre></div><p>最后出现异常后，保存的文件格式为 java_pidxxx.hprof，pid 后面是发生溢出的进程 id，之后可以用 VisualVM、JProfiler 等工具打开分析。</p><h4 id=设置垃圾回收器类型>设置垃圾回收器类型</h4><p>随着 JDK 版本的升级，可使用的垃圾收集器类型也越来越多了。JDK 8 可使用的垃圾收集器有 7 种，当然有点只适用于年轻代，有点只使用于老年代，JDK 8 中最新的垃圾收集器是 G1，可以用于年轻代和老年代。到了 JDK 11，还出了 ZGC。</p><p>下图是 JDK 8 中可使用的垃圾收集器以及它们配合使用的关系。
<img src=https://hexo.moonkite.cn/blog/273364-20191115085321229-534280849.png alt>
Serial、ParNew、Parallel Scavenge 只适用于年轻代，CMS、Serial Old、Parallel Old 只适用于老年代，而 G1 通用于年轻代和老年代。连线表示它们之间可配合使用的关系，其中 CMS 和 Serial Old 连线的意思是说 Serial Old 会作为 CMS 的后预案，当 CMS 发生 Concurrent Mode Failure 时启用。</p><p>在 JDK 8 中，如果不指定垃圾收集器，默认使用参数 <code>-XX:+UseParallelGC </code>，新生代使用 Parallel Scavenge，老年代使用 Serial Old。</p><p><strong>-XX:+UseSerialGC</strong>：使用 Serial + Serial Old ，运行于 client 模式下的默认设置</p><p><strong>-XX:+UseConcMarkSweepGC</strong>：使用 ParNew+CMS+Serial Old，CMS 垃圾收集器</p><p><strong>-XX:+UseParallelGC</strong>：Parallel Scavenge + Serial Old，JDK 8 server 模式下的默认设置</p><p><strong>-XX:+UseParallelOldGC</strong>：Parallel Scavenge + Parallel Old</p><p><strong>-XX:+UseG1GC</strong>：使用 G1 垃圾收集器</p><p>####开启远程 JMX 监控</p><p>除了日志外，当我们需要实时查看 JVM 运行情况的时候怎么办，当然可以到 JVM 所在服务器用 jstack、jmap、jinfo 等工具进行查看，但是又不够直观，这时候就需要开启 JMX 远程功能，使用 jConsole、VisualVM 等工具进行监控。或者自己开发监控平台，比如我之前就做了一个 web 版的简易 VisualVm。<a href=https://mp.weixin.qq.com/s/df1XroHcS6KYj4ftkzwKfQ>无意中就做了个 web 版 JVM 监控端</a></p><p>开启参数如下：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-properties data-lang=properties><span class=line><span class=cl><span class=err>-Dcom.sun.management.jmxremote</span>
</span></span><span class=line><span class=cl><span class=c1>#指定 jvm 所在服务器 ip 或域名</span>
</span></span><span class=line><span class=cl><span class=na>-Djava.rmi.server.hostname</span><span class=o>=</span><span class=s>192.168.1.1</span>
</span></span><span class=line><span class=cl><span class=c1>#指定端口</span>
</span></span><span class=line><span class=cl><span class=na>-Dcom.sun.management.jmxremote.port</span><span class=o>=</span><span class=s>9999</span>
</span></span><span class=line><span class=cl><span class=na>-Dcom.sun.management.jmxremote.rmi.port</span><span class=o>=</span><span class=s>9999</span>
</span></span><span class=line><span class=cl><span class=na>-Dcom.sun.management.jmxremote.authenticate</span><span class=o>=</span><span class=s>false</span>
</span></span><span class=line><span class=cl><span class=na>-Dcom.sun.management.jmxremote.ssl</span><span class=o>=</span><span class=s>false</span>
</span></span></code></pre></div></article><div class=toc><h2>文章目录</h2><nav id=TableOfContents><ul><li><ul><li></li></ul></li></ul></nav></div><script>window.addEventListener("scroll",function(){var e=document.querySelector(".toc"),t=window.pageYOffset||document.documentElement.scrollTop,n=window.innerWidth||document.documentElement.clientWidth;t<360?e.style.top=380-t+"px":e.style.top="20px"})</script><h4>相关文章</h4><dl class=row><dd class=col-md-9><a href=/category/java/JDK17/>新项目为什么决定用 JDK 17了</a></dd><dd class=col-md-9><a href=/category/java/Graalvm/>过两年 JVM 可能就要被GraalVM替代了</a></dd><dd class=col-md-9><a href=/category/java/JVM-%E5%86%85%E5%AD%98%E6%BA%A2%E5%87%BA%E7%9A%84%E5%8E%9F%E5%9B%A0%E5%8F%8A%E9%A2%84%E9%98%B2/>JVM 内存溢出的原因及预防</a></dd><dd class=col-md-9><a href=/category/java/%E5%A6%82%E4%BD%95%E7%BC%96%E8%AF%91%E8%87%AA%E5%B7%B1%E7%9A%84-JDK/>手把手教你编译属于自己的 JDK</a></dd><dd class=col-md-9><a href=/category/java/Java-%E5%AD%97%E7%AC%A6%E4%B8%B2%E6%BC%AB%E6%B8%B8%E6%8C%87%E5%8D%97/>Java 字符串常量池漫游指南（图文并茂）</a></dd></dl><div class=author-card><div class=underline></div><div class=author-box><div class=qr-author-image><a href=/><img src=/images/person.png alt=风筝></a></div><div class=author-content><p class=author-title>作者</p><p class=author-name>风筝</p><p class=author-desc>古时的风筝，一个平庸的程序员，主语言 Java，第二语言 Python，其实学 Python 的时间比 Java 还要早。喜欢写博客，写博客的过程能加深自己对一个知识点的理解，同时还可以分享给他人。喜欢做一些小东西，所以也会一些前端的东西，React、JavaScript、CSS 都会一些，做一些小工具还够用。</p></div></div></div><script src=https://utteranc.es/client.js repo=huzhicheng/blog-comment issue-term=pathname theme=github-light crossorigin=anonymous async></script></div></main><div class="footer gradient-2"><div class="container footer-container"><div class=row><div class="col-xs-4 col-sm-3 col-md-3 col-lg-3"><div class=footer-title>网站地图</div><ul class=list-unstyled><li><a href=https://www.moonkite.cn/tags/>标签</a></li><li><a href=https://www.moonkite.cn/categories/>分类</a></li><li><a rel=alternate type=application/rss+xml href=https://www.moonkite.cn/index.xml><i class="fas fa-rss-square"></i> RSS订阅</a></li></ul></div><div class="col-xs-4 col-sm-3 col-md-3 col-lg-3"><div class=footer-title>社群</div><ul class=list-unstyled><li><a href=https://github.com/huzhicheng rel=noopener target=_blank>GitHub</a></li></ul></div><div class="col-xs-4 col-sm-3 col-md-3 col-lg-3"><div class=footer-title>友链</div><ul class=list-unstyled><li><a href=https://github.com/huzhicheng rel=noopener target=_blank>关于我</a></li></ul></div><div class="col-xs-12 col-sm-3 col-md-3 col-lg-3"><p class="pull-right text-right"><small><em>Proudly powered by <a href=https://gohugo.io/ rel=noopener target=_blank>Hugo</a></em></small><br><small><em>Theme - <a href=https://github.com/shaform/hugo-theme-den rel=noopener target=_blank>Den</a></em></small><br><small>&copy;
风筝
2023</small></p></div></div><script>var _hmt=_hmt||[];(function(){var e,t=document.createElement("script");t.src="https://hm.baidu.com/hm.js?e417ddf834c7bb7411207e1fa09815aa",e=document.getElementsByTagName("script")[0],e.parentNode.insertBefore(t,e)})()</script><script async src="https://www.googletagmanager.com/gtag/js?id=G-C714TFXRD4"></script>
<script>window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-C714TFXRD4")</script><div class=busuanzi-footer><span id=busuanzi_container_site_pv>本站总访问量<span id=busuanzi_value_site_pv></span>次</span>
<span id=busuanzi_container_site_uv>本站访客数<span id=busuanzi_value_site_uv></span>人次</span></div></div></div><script src=https://code.jquery.com/jquery-3.3.1.slim.min.js integrity=sha384-q8i/X+965DzO0rT7abK41JStQIAqVgRVzpbzo5smXKp4YfRvH+8abtTE1Pi6jizo crossorigin=anonymous></script>
<script src=https://cdn.staticfile.org/popper.js/1.14.3/umd/popper.min.js integrity=sha384-ZMP7rVo3mIykV+2+9J3UJ46jBk0WLaUAdn689aCwoqbBJiSnjAK/l8WvCWPIPm49 crossorigin=anonymous></script>
<script src=https://cdn.staticfile.org/twitter-bootstrap/4.1.3/js/bootstrap.js></script>
<script>$(document).ready(function(){$("#load_disqus").length&&$(window).scroll(function(){if($("#load_disqus").length){var e=$("#load_disqus").offset().top,t=$(window).scrollTop(),n=t+$(window).height();t<e&&e<n&&load_disqus()}})})</script></body></html>